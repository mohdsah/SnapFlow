<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SnapFlow</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background: #000;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .splash-logo {
            font-size: 42px;
            font-weight: 900;
            background: linear-gradient(135deg, #fff 30%, #fe2c55 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1px;
        }
        .splash-tagline {
            color: #444;
            font-size: 14px;
            margin-top: 8px;
        }
        .splash-loader {
            position: absolute;
            bottom: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }
    </style>
</head>
<body>
    <div style="text-align:center;">
        <div class="splash-logo">SnapFlow</div>
        <p class="splash-tagline">Kongsi Momen Anda Bersama Dunia ðŸŽ¬</p>
    </div>
    <div class="splash-loader">
        <div class="loader-spin"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
    <script>
    (async function initSplash() {
        try {
            // Semak sesi yang sedia ada
            const { data: { session } } = await snapSupabase.auth.getSession();
            setTimeout(function() {
                if (session && session.user) {
                    // Dah login â€” balik ke page asal atau index
                    const redir = sessionStorage.getItem('sf_redirect_after_login');
                    if (redir && !['login.html','register.html','splash.html'].some(function(p){ return redir.includes(p); })) {
                        sessionStorage.removeItem('sf_redirect_after_login');
                        window.location.replace(redir);
                    } else {
                        window.location.replace('index.html');
                    }
                } else {
                    window.location.replace('login.html');
                }
            }, 1800);
        } catch(e) {
            setTimeout(function() { window.location.replace('login.html'); }, 1800);
        }
    })();
    </script>

    <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/service-worker.js').catch(function(){});
        });
    }
    </script>
</body>
</html>
